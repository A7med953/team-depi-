<div class="reports-container">
  <header class="reports-header">
    <div class="header-content">
      <h1>Reports & Analytics</h1>
      <p class="header-subtitle">Track your pharmacy's performance and insights</p>
    </div>
    <div class="header-actions">
      <button class="export-btn" (click)="exportReport()">
        <i class="fas fa-download"></i> Export Report
      </button>
    </div>
  </header>

  <section class="stats-section">
    <div class="stat-card">
      <div class="stat-icon">
        <i class="fas fa-dollar-sign"></i>
      </div>
      <div class="stat-content">
        <h3 class="stat-label">Total Sales</h3>
        <p class="stat-value">$24,580.50</p>
        <span class="stat-change positive">+12.5% from last month</span>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">
        <i class="fas fa-prescription-bottle-alt"></i>
      </div>
      <div class="stat-content">
        <h3 class="stat-label">Prescriptions</h3>
        <p class="stat-value">342</p>
        <span class="stat-change positive">+8 from last week</span>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">
        <i class="fas fa-warehouse"></i>
      </div>
      <div class="stat-content">
        <h3 class="stat-label">Inventory Value</h3>
        <p class="stat-value">$156,800.00</p>
        <span class="stat-change neutral">No change</span>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">
        <i class="fas fa-users"></i>
      </div>
      <div class="stat-content">
        <h3 class="stat-label">Active Patients</h3>
        <p class="stat-value">1,284</p>
        <span class="stat-change positive">+23 this month</span>
      </div>
    </div>
  </section>

  <section class="charts-section">
    <div class="chart-card">
      <h3>Sales Trend</h3>
      <canvas id="salesTrend"></canvas>
    </div>

    <div class="chart-card">
      <h3>Top Selling Medications</h3>
      <canvas id="topMedications"></canvas>
    </div>

    <div class="chart-card">
      <h3>Sales by Category</h3>
      <canvas id="salesCategory"></canvas>
    </div>

    <div class="chart-card">
      <h3>Inventory Value Trend</h3>
      <canvas id="inventoryTrend"></canvas>
    </div>
  </section>

  <!-- Filter Section -->
  <section class="filter-section">
    <div class="filter-group">
      <label for="reportType">Report Type</label>
      <select id="reportType" class="filter-select" [(ngModel)]="selectedReportType" (change)="filterReports()">
        <option value="all">All Reports</option>
        <option value="sales">Sales Reports</option>
        <option value="prescription">Prescription Reports</option>
        <option value="inventory">Inventory Reports</option>
        <option value="financial">Financial Reports</option>
      </select>
    </div>

    <div class="filter-group">
      <label for="dateRange">Date Range</label>
      <select id="dateRange" class="filter-select" [(ngModel)]="selectedDateRange" (change)="filterReports()">
        <option value="today">Today</option>
        <option value="week">This Week</option>
        <option value="month">This Month</option>
        <option value="quarter">This Quarter</option>
        <option value="year">This Year</option>
        <option value="custom">Custom Range</option>
      </select>
    </div>

    <div class="filter-group">
      <button class="generate-btn" (click)="generateReport()">
        <i class="fas fa-chart-bar"></i> Generate Report
      </button>
    </div>
  </section>

  <!-- Reports List -->
  <section class="reports-section">
    <div class="section-header">
      <h2>Available Reports</h2>
      <span class="report-count">{{ filteredReports.length }} report{{ filteredReports.length !== 1 ? 's' : '' }}</span>
    </div>

    <div class="reports-grid">
      <div 
        *ngFor="let report of filteredReports" 
        class="report-card"
        [class.sales]="report.category === 'sales'"
        [class.prescription]="report.category === 'prescription'"
        [class.inventory]="report.category === 'inventory'"
        [class.financial]="report.category === 'financial'">
        
        <div class="report-card-header">
          <div class="report-icon">
            <i [class]="report.icon"></i>
          </div>
          <div class="report-title-section">
            <h3 class="report-title">{{ report.title }}</h3>
            <span class="report-category">{{ report.category }}</span>
          </div>
        </div>

        <p class="report-description">{{ report.description }}</p>

        <div class="report-meta">
          <div class="meta-item">
            <i class="fas fa-calendar"></i>
            <span>{{ report.lastGenerated }}</span>
          </div>
          <div class="meta-item">
            <i class="fas fa-file"></i>
            <span>{{ report.size }}</span>
          </div>
        </div>

        <div class="report-actions">
          <button class="view-btn" (click)="viewReport(report.id)">
            <i class="fas fa-eye"></i> View
          </button>
          <button class="download-btn" (click)="downloadReport(report.id)">
            <i class="fas fa-download"></i> Download
          </button>
        </div>
      </div>
    </div>
  </section>

  <section class="activity-section">
    <div class="section-header">
      <h2>Recent Activity</h2>
    </div>

    <div class="activity-table">
      <div class="table-header">
        <div class="table-cell">Date</div>
        <div class="table-cell">Activity</div>
        <div class="table-cell">Type</div>
        <div class="table-cell">Status</div>
      </div>

      <div *ngFor="let activity of recentActivities" class="table-row">
        <div class="table-cell">
          <span class="date-text">{{ activity.date }}</span>
          <span class="time-text">{{ activity.time }}</span>
        </div>
        <div class="table-cell activity-text">{{ activity.description }}</div>
        <div class="table-cell">
          <span class="type-badge" [class]="activity.type">{{ activity.type }}</span>
        </div>
        <div class="table-cell">
          <span class="status-badge" [class]="activity.status">{{ activity.status }}</span>
        </div>
      </div>
    </div>
  </section>
</div>

<!-- Generate Report Modal -->
<div class="modal-overlay" *ngIf="showGenerateModal" (click)="closeGenerateModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2><i class="fas fa-chart-bar"></i> Generate New Report</h2>
      <button class="modal-close" (click)="closeGenerateModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="modal-body">
      <div class="form-group">
        <label for="reportTitle">Report Title <span class="required">*</span></label>
        <input 
          type="text" 
          id="reportTitle" 
          class="form-input" 
          [(ngModel)]="newReport.title"
          placeholder="Enter report title">
      </div>

      <div class="form-group">
        <label for="reportDescription">Description <span class="required">*</span></label>
        <textarea 
          id="reportDescription" 
          class="form-textarea" 
          [(ngModel)]="newReport.description"
          placeholder="Enter report description"
          rows="3"></textarea>
      </div>

      <div class="form-group">
        <label for="reportCategory">Category <span class="required">*</span></label>
        <select id="reportCategory" class="form-select" [(ngModel)]="newReport.category">
          <option value="sales">Sales</option>
          <option value="prescription">Prescription</option>
          <option value="inventory">Inventory</option>
          <option value="financial">Financial</option>
        </select>
      </div>

      <div class="form-group">
        <label for="reportFile">Attach File (Optional)</label>
        <div class="file-input-wrapper">
          <input 
            type="file" 
            id="reportFile" 
            class="file-input"
            (change)="onFileSelected($event)"
            accept=".pdf,.xlsx,.xls,.csv,.doc,.docx">
          <label for="reportFile" class="file-input-label">
            <i class="fas fa-cloud-upload-alt"></i>
            <span>{{ newReport.file ? newReport.file.name : 'Choose file or drag here' }}</span>
          </label>
        </div>
        <small class="form-hint">Supported formats: PDF, Excel, CSV, Word</small>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeGenerateModal()">
        <i class="fas fa-times"></i> Cancel
      </button>
      <button class="btn-primary" (click)="submitNewReport()">
        <i class="fas fa-check"></i> Generate Report
      </button>
    </div>
  </div>
</div>

<!-- Alert Modal -->
<div class="alert-overlay" *ngIf="showAlertModal" (click)="closeAlert()">
  <div class="alert-box" [class]="alertType" (click)="$event.stopPropagation()">
    <div class="alert-icon">
      <i *ngIf="alertType === 'success'" class="fas fa-check-circle"></i>
      <i *ngIf="alertType === 'error'" class="fas fa-exclamation-circle"></i>
      <i *ngIf="alertType === 'info'" class="fas fa-info-circle"></i>
    </div>
    <div class="alert-content">
      <p>{{ alertMessage }}</p>
    </div>
    <button class="alert-close" (click)="closeAlert()">
      <i class="fas fa-times"></i>
    </button>
  </div>
</div>