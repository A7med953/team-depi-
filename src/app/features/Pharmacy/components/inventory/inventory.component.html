<div class="dashboard-container">
  <header class="dashboard-header">
    <div class="title-and-alerts">
      <h1>Inventory Management</h1>
      <p class="header-alerts-text">
        <span class="low-stock-count">{{ lowStockCount }}</span> â€¢
        <span class="expiring-count">{{ expiringCount }}</span>
      </p>
    </div>
    <div class="header-buttons">
      <button class="add-item-btn refresh-btn" (click)="refreshInventory()">
        <i class="fas fa-sync-alt"></i> Refresh
      </button>
      <button class="add-item-btn" routerLink="/pharmacy/add-item">
        <i class="fas fa-plus"></i> Add Item
      </button>
    </div>
  </header>

  <section class="alerts-section">
    <div class="alert-card low-stock-alert">
      <div class="alert-header">
        <i class="fas fa-exclamation-triangle alert-icon"></i>
        <h2>Low Stock Alerts</h2>
      </div>
      <ul class="alert-list">
        <li *ngIf="lowStockItems.length === 0" class="alert-item">No low stock items</li>
        <li *ngFor="let item of lowStockItems" class="alert-item">
          <span>{{ item.name }}</span>
          <span class="alert-count">{{ item.stock }} left</span>
        </li>
      </ul>
    </div>

    <div class="alert-card expiring-alert">
      <div class="alert-header">
        <i class="fas fa-calendar-times alert-icon"></i>
        <h2>Expiring Soon</h2>
      </div>
      <ul class="alert-list">
        <li *ngIf="expiringItems.length === 0" class="alert-item">No expiring items</li>
        <li *ngFor="let item of expiringItems" class="alert-item" [class.expiring-danger-text]="isExpiringSoon(item.expiry)">
          <span>{{ item.name }}</span>
          <span class="alert-date">{{ formatDate(item.expiry) }}</span>
        </li>
      </ul>
    </div>
  </section>

  <section class="search-section">
    <div class="search-input-wrapper">
      <i class="fas fa-search"></i>
      <input
        type="text"
        [(ngModel)]="searchTerm"
        placeholder="Search by medication name, category, or supplier..."
        id="searchInput"
      />
    </div>
  </section>

  <main class="inventory-list-container">
    <div *ngFor="let item of filteredInventory()" class="inventory-card">
      <div class="card-header-content">
        <div class="medication-details">
          <i class="fas fa-pills medication-icon"></i>
          <div>
            <span class="medication-name">{{ item.name }}</span>
            <span class="medication-sub-details">{{ item.category }} | Batch: {{ item.batch }}</span>
          </div>
        </div>
        <div class="stock-tags">
          <span class="tag" [ngClass]="item.stock <= item.minStock ? 'low-stock-tag' : 'normal-stock'">
            {{ item.stock <= item.minStock ? 'low stock' : 'normal stock' }}
          </span>
          <span *ngIf="isExpiringSoon(item.expiry)" class="tag expiring-soon-tag">Expiring Soon</span>
        </div>
      </div>

      <div class="card-body-content">
        <div class="detail-group">
          <p class="detail-item">
            <span class="label">Current Stock:</span>
            <span class="value" [ngClass]="{ 'low-stock-value': item.stock <= item.minStock }">{{ item.stock }}</span>
          </p>
          <p class="detail-item">
            <span class="label">Unit Price:</span>
            <span class="value">${{ item.price }}</span>
          </p>
          <p class="detail-item">
            <span class="label">Expiry Date:</span>
            <span class="value" [ngClass]="getExpiryClass(item.expiry)">{{ formatDate(item.expiry) }}</span>
          </p>
        </div>
        <div class="detail-group">
          <p class="detail-item"><span class="label">Min Stock:</span> <span class="value">{{ item.minStock }}</span></p>
          <p class="detail-item"><span class="label">Supplier:</span> <span class="value">{{ item.supplier }}</span></p>
        </div>
      </div>

      <div class="card-actions">
        <button class="action-btn update-btn" [routerLink]="['/pharmacy/update-stock']" [queryParams]="{ medication: item.name }">
          Update Stock
        </button>
      </div>
    </div>
  </main>

  <div class="last-updated">
    Last updated: <span>{{ lastUpdatedTime }}</span>
  </div>
</div>
